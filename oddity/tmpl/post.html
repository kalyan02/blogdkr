<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Meta.Title}}</title>
    <meta name="description" content="{{.Meta.Description}}">
    {{if .Meta.Keywords}}<meta name="keywords" content="{{range $i, $k := .Meta.Keywords}}{{if $i}}, {{end}}{{$k}}{{end}}">{{end}}
    {{if .Meta.Author}}<meta name="author" content="{{.Meta.Author}}">{{end}}
    {{if .Meta.CanonicalURL}}<link rel="canonical" href="{{.Meta.CanonicalURL}}">{{end}}
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'mono': ['JetBrains Mono', 'monospace'],
                    }
                }
            }
        }
    </script>
</head>
<body class="font-mono bg-white min-h-screen">
    <!-- Navigation Bar -->
    <div class="py-1 border-b-0 border-gray-100">
        <div class="max-w-4xl mx-auto px-2 pb-2 pt-2 flex flex-col lg:flex-row items-start lg:items-center lg:justify-between gap-2 {{if .IsAuthenticated}} border-l border-l-green-400{{end}} {{if .IsPrivate}}border-b border-b-orange-300{{end}}">
            <!-- Left: Site Title -->
            <!--
            <div class="flex gap-1 flex-wrap justify-center lg:justify-start">
                <a href="/" class="text-gray-900 text-sm font-semibold px-1 py-1 rounded hover:bg-gray-100 transition-colors">
                    {{.Site.Title}}
                </a>
            </div>
            -->

            <!-- Right: Navigation Links -->
            {{if or .Site.Navigation .NewPostHintSlug}}
            <div class="flex flex-wrap gap-1 justify-start lg:justify-center w-full lg:w-auto">
                {{range .Site.Navigation}}
                <a href="{{.URL}}" 
                   {{if .IsExternal}}target="_blank" rel="noopener noreferrer"{{end}}
                   class="text-gray-600 text-xs px-2 py-1 rounded hover:bg-gray-100 hover:text-gray-900 transition-colors{{if .IsActive}} bg-blue-600 text-white hover:bg-blue-700 hover:text-white{{end}}">
                    {{.Name}}
                </a>
                {{end}}
                {{ if and .NewPostHintSlug .IsAuthenticated }}
                    <input type="text" value="/{{.NewPostHintSlug}}" id="new-post-hint"
                      class="text-xs px-2 py-1 border border-gray-300 rounded bg-gray-50 text-gray-500 cursor-pointer w-full max-w-60 lg:w-60" />

                    <input type="button" value="Add"
                      onclick="location.href='/admin/edit?path=' + document.getElementById('new-post-hint').value"
                      class="text-xs px-2 py-1 border border-gray-300 rounded bg-gray-100 text-gray-600 hover:bg-gray-200 cursor-pointer" />

                    <a href="/auth" class="text-xs px-2 py-1 border border-gray-300 rounded bg-gray-100 text-gray-600 hover:bg-gray-200 cursor-pointer">
                        Auth
                    </a>
                    <a href="/auth/logout" class="text-xs px-2 py-1 border border-gray-300 rounded bg-gray-100 text-gray-600 hover:bg-gray-200 cursor-pointer">
                        Logout
                    </a>

                {{end}}
            </div>
            {{end}}
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-4xl mx-auto px-4 py-8">
        <!-- Page Header -->
        <header class="mb-4 pb-4">
            <h1 class="text-3xl font-bold text-gray-900 mb-3">{{.Meta.Title}}</h1>

            {{if or .CreatedDate .ModifiedDate .WordCount .ReadingTime}}
            <div class="flex flex-wrap items-center gap-4 text-xs text-gray-500">
                {{if .CreatedDate}}
                <span>Created {{.CreatedDate.Format "2006-01-02"}}</span>
                {{end}}
                {{if .ModifiedDate}}
                {{if ne .CreatedDate.Format "2006-01-02" .ModifiedDate.Format "2006-01-02"}}
                <span>•</span>
                <span>Modified {{.ModifiedDate.Format "2006-01-02"}}</span>
                {{end}}
                {{end}}
                {{if .WordCount}}
                <span>•</span>
                <span>{{.WordCount}} words</span>
                {{end}}
                {{if .ReadingTime}}
                <span>•</span>
                <span>{{.ReadingTime}}m read</span>
                {{end}}
            </div>
            {{end}}
            
            {{if .Tags}}
            <div class="flex flex-wrap gap-2 mt-3">
                {{range .Tags}}
                <span class="text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded">
                    {{.}}
                </span>
                {{end}}
            </div>
            {{end}}
        </header>

        <!-- Post Content -->
        <article class="prose prose-sm max-w-none font-mono text-sm leading-relaxed">
            {{.PageHTML}}
        </article>

        <!-- Post Footer -->
        <footer class="mt-12 pt-8 border-t border-gray-100">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
                <!-- Back to posts -->
                <a href="/posts" class="text-xs text-gray-600 hover:text-gray-900 uppercase tracking-wider transition-colors">
                    ← Back
                </a>
                
                <!-- Share or edit links could go here -->
                <div class="flex gap-2 text-xs">
                    {{if .IsAuthenticated}}
                    {{if .EditURL}}
                    <a href="{{.EditURL}}" class="text-gray-600 hover:text-gray-900 px-2 py-1 border border-gray-300 rounded transition-colors">
                        Edit
                    </a>
                    {{end}}
                    {{end}}
                </div>
            </div>
        </footer>

        <!-- Wiki-style Links Section -->
        {{if or .LinkedPages .Backlinks}}
        <div class="mt-12 pt-8 border-t border-gray-100 space-y-8">
            {{if .LinkedPages}}
            <section>
                <h3 class="text-sm font-semibold text-gray-900 mb-3 uppercase tracking-wider">Linked Pages</h3>
                <div class="space-y-2">
                    {{range .LinkedPages}}
                    <div>
                        <a href="/{{.Slug}}" class="text-sm text-blue-600 hover:text-blue-800 transition-colors">
                            {{.Title}}
                        </a>
                        {{if .Excerpt}}
                        <p class="text-xs text-gray-600 mt-1">{{.Excerpt}}</p>
                        {{end}}
                    </div>
                    {{end}}
                </div>
            </section>
            {{end}}

            {{if .Backlinks}}
            <section>
                <h3 class="text-sm font-semibold text-gray-900 mb-3 uppercase tracking-wider">Backlinks</h3>
                <div class="space-y-2">
                    {{range .Backlinks}}
                    <div>
                        <a href="/{{.Slug}}" class="text-sm text-green-600 hover:text-green-800 transition-colors">
                            {{.Title}}
                        </a>
                        {{if .Excerpt}}
                        <p class="text-xs text-gray-600 mt-1">{{.Excerpt}}</p>
                        {{end}}
                    </div>
                    {{end}}
                </div>
            </section>
            {{end}}
        </div>
        {{end}}

        <!-- Site Footer -->
        <div class="mt-16 pt-8 border-t border-gray-100 text-center">
            <p class="text-xs text-gray-500">
                Powered by <a href="https://github.com/your-repo/oddity" class="hover:text-gray-700">Oddity</a>
            </p>
        </div>
    </div>

    <style>
        /* Comprehensive prose styles for blog content */
        .prose {
            color: #374151;
        }
        
        /* Headings */
        .prose h1 {
            font-size: 1.875rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            margin-top: 2rem;
            color: #111827;
            line-height: 1.25;
        }
        .prose h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            margin-top: 2rem;
            color: #111827;
            line-height: 1.25;
        }
        .prose h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            margin-top: 1.5rem;
            color: #111827;
            line-height: 1.25;
        }
        .prose h4 {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            margin-top: 1.25rem;
            color: #111827;
        }
        .prose h5, .prose h6 {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            margin-top: 1rem;
            color: #111827;
        }

        /* Paragraphs and text */
        .prose p {
            margin-bottom: 1.25rem;
            line-height: 1.75;
        }
        .prose strong {
            font-weight: 600;
            color: #111827;
        }
        .prose em {
            font-style: italic;
        }

        /* Links */
        .prose a {
            color: #2563eb;
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: border-color 0.2s;
        }
        .prose a:hover {
            border-bottom-color: #2563eb;
        }

        /* Code */
        .prose code {
            background-color: #f3f4f6;
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            font-size: 0.875em;
            color: #dc2626;
            border: 1px solid #e5e7eb;
        }
        .prose pre {
            background-color: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1.5rem;
            overflow-x: auto;
            margin: 1.5rem 0;
            font-size: 0.875rem;
            line-height: 1.5;
        }
        .prose pre code {
            background: none;
            padding: 0;
            border: none;
            color: inherit;
            font-size: inherit;
        }

        /* Blockquotes */
        .prose blockquote {
            border-left: 4px solid #d1d5db;
            padding-left: 1.5rem;
            margin: 1.5rem 0;
            font-style: italic;
            color: #6b7280;
            background-color: #f9fafb;
            padding: 1rem 1.5rem;
            border-radius: 0 0.375rem 0.375rem 0;
        }
        .prose blockquote p {
            margin-bottom: 0;
        }

        /* Lists */
        .prose ul, .prose ol {
            margin: 1.25rem 0;
            padding-left: 1.75rem;
        }
        .prose ul {
            list-style-type: disc;
        }
        .prose ol {
            list-style-type: decimal;
        }
        .prose li {
            margin-bottom: 0.3rem;
            line-height: 1.75;
        }
        .prose li p {
            margin-bottom: 0.5rem;
        }
        .prose ul ul, .prose ul ol, .prose ol ul, .prose ol ol {
            margin: 0.5rem 0;
        }

        /* Tables */
        .prose table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            font-size: 0.875rem;
        }
        .prose th, .prose td {
            border: 1px solid #d1d5db;
            padding: 0.75rem;
            text-align: left;
        }
        .prose th {
            background-color: #f3f4f6;
            font-weight: 600;
            color: #374151;
        }
        .prose tr:nth-child(even) {
            background-color: #f9fafb;
        }

        /* Images */
        .prose img {
            max-width: 100%;
            height: auto;
            margin: 1.5rem 0;
            border-radius: 0.5rem;
            border: 1px solid #e5e7eb;
        }

        /* Horizontal rules */
        .prose hr {
            border: none;
            border-top: 1px solid #e5e7eb;
            margin: 2rem 0;
        }

        /* Definition lists */
        .prose dl {
            margin: 1.25rem 0;
        }
        .prose dt {
            font-weight: 600;
            color: #111827;
            margin-bottom: 0.25rem;
        }
        .prose dd {
            margin-bottom: 1rem;
            padding-left: 1.5rem;
        }

        /* Special elements */
        .prose kbd {
            background-color: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 0.25rem;
            padding: 0.125rem 0.375rem;
            font-size: 0.875em;
            font-weight: 600;
        }
        .prose mark {
            background-color: #fef3c7;
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
        }
        .prose sup, .prose sub {
            font-size: 0.75em;
            line-height: 0;
            position: relative;
        }
        .prose sup {
            top: -0.5em;
        }
        .prose sub {
            bottom: -0.25em;
        }

        /* Task lists (GitHub-style checkboxes) */
        .prose .task-list-item {
            list-style: none;
            margin-left: -1.75rem;
        }
        .prose .task-list-item input[type="checkbox"] {
            margin-right: 0.5rem;
        }
    </style>
</body>
</html>